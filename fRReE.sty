%%
%% This is file `RR.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% RR.dtx  (with options: `RR')
%% ********************************************************************
%% Copyright (C) 2012 CNRS/LIMOS/ISIMA by Jonathan Passerat-Palmbach
%% forked from RR.sty by
%% Copyright (C) 1997-1999 2004 2006-2011 INRIA/APICS/MARELLE by Jose' Grimm
%%
%% This file may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2003/12/01 or later.

% package description
\def\RRfiledate{2014/05/19}
\def\RRfileversion{0.2}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{fRReE}
       [\RRfiledate\space v\RRfileversion\space
         Copyright Jonathan Passerat-Palmbach]
\typeout{Research Report template version 
\RRfileversion\space of \RRfiledate}

% set default options and ask for required packages
\newif\ifRR@french \RR@frenchfalse
\newif\ifRR@firstpage \RR@firstpagefalse
\newif\if@dc@french \@dc@frenchfalse
\def\RR@badoption#1{\@latex@error
   {Option `#1' removed, see documentation}\@eha}
\DeclareOption{french}{\@dc@frenchtrue}
\DeclareOption{T1}{\RR@badoption{T1}}
\DeclareOption{OT1}{\RR@badoption{OT1}}
\DeclareOption{noinputenc}{\RR@badoption{noinputenc}}
\DeclareOption{utf8}{\RR@badoption{utf8}}
\ProcessOptions\relax
\RequirePackage{textcomp}
\RequirePackage{color}
\RequirePackage{graphicx}
\RequirePackage{url}
\RequirePackage[update,prepend]{epstopdf}
\RequirePackage{filecontents}
%% \@twosidetrue

% select fonts assigned to various elements in the report
\def\@psenc{T1}
\newcommand\times@font{\fontencoding{T1}\fontfamily{ptm}}
\newcommand\helvetica@font{\fontencoding{T1}\fontfamily{phv}}
\newcommand\title@font{\times@font\fontseries{b}%
   \fontshape{n}\fontsize{36pt}{40pt}\selectfont}
\newcommand\rrno@font{\times@font\fontseries{b}%
   \fontshape{n}\fontsize{15pt}{20pt}\selectfont}
\newcommand\author@font{\times@font\fontseries{b}%
   \fontshape{n}\fontsize{13.3pt}{16pt}\selectfont}
\newcommand\theme@font{\times@font\fontseries{m}%
   \fontshape{n}\fontsize{10pt}{11pt}\selectfont}
\newcommand\issn@font{\helvetica@font\fontseries{m}%
   \fontshape{n}\fontsize{8pt}{10pt}\selectfont}
\newcommand\cr@font{\helvetica@font\fontseries{b}%
   \fontshape{n}\fontsize{7.5pt}{10pt}\selectfont}

% define a box that will be used later to handle the layout
% of the first two pages
\newbox\RR@atxybox%
\newif\ifRR@atxy\RR@atxyfalse
\newcommand\RR@atxy[3]{\global\setbox\RR@atxybox=\hbox
 {\unhbox\RR@atxybox
  \vtop to 0pt{\kern #2\hbox to 0pt{\kern #1\relax #3\hss}\vss}}%
 \global\RR@atxytrue}
\def\@userratxy{%
 \ifRR@atxy{%
  \if@twoside
    \ifodd\count\z@
         \let\@themargin\oddsidemargin
    \else \let\@themargin\evensidemargin
    \fi
  \fi
  \vtop to 0pt{\kern-\headsep \kern-\topmargin \kern-\headheight
               \kern-1in \kern-\voffset
               \hbox to 0pt{\kern-\@themargin \kern-1in \kern-\hoffset
                            \unhbox\RR@atxybox \hss}\vss}%
 }\fi
 \global\RR@atxyfalse}%
\AtBeginDocument{\toks0={\setbox255=\vbox{\@userratxy \unvbox255}}
\output=\expandafter{\the\toks0\the\output}}

% title and author information to appear in headers
% these are automaticaly set by the parameter of RR* commands 
\let\titlehead=\undefined
\newcommand\titlehead[1]{\gdef\@titlehead{#1}}
\newcommand\authorhead[1]{\gdef\@authorhead{#1}}
\titlehead{}
\authorhead{}

% define commands to set compuslory elements such as: number, date, author
\newcommand\RRenableFirstPage{\RR@firstpagetrue}
\newcommand\RRsource[1]{\gdef\RR@source{#1}}
\newcommand\RR@source{????}
\newcommand\RRoriginalpages[1]{\gdef\RR@originalpages{#1}}
\newcommand\RR@originalpages{????}
\newcommand\RRadditionalinformation[1]{\gdef\RR@additionalinformation{#1}}
\newcommand\RR@additionalinformation{????}
\newcommand\RRcopyright[1]{\gdef\RR@copyright{#1}}
\newcommand\RR@copyright{????}
\newcommand\RRlogo[1]{\gdef\RR@logo{#1}}
\newcommand\RR@logo{logos/gingy.eps}
\newcommand\RRfooterLastPage[1]{\gdef\RR@footerLastPage{#1}}
\newcommand\RR@footerLastPage{Publisher\\ LIMOS - UMR CNRS 6158 \\ Campus des C\'ezeaux \\ B\^atiment ISIMA\\
      BP 10125 - 63173 Aubi\`ere Cedex\\\url{http://limos.isima.fr}\\\url{http://www.isima.fr}}
      
\newcommand\RR@month{\ifcase\the\month
 \or Janvier\or F\'evrier\or Mars\or Avril\or Mai\or Juin \or Juillet%
 \or Ao\^ut\or Septembre\or Octobre\or Novembre\or D\'ecembre\fi}
\newcommand\RRdate[1]{\gdef\RR@date{#1}}
\newcommand\RR@date{%
 \protected@xdef\RR@date{\RR@month\space \number\the\year}%
 \RR@date%
 \@warning{No \string\RRdate \space seen:
         \RR@date\space will be used.}}
\newcommand\RRdater[1]{\gdef\RR@dater{#1}}
\newcommand\RR@dater{%
 \protected@xdef\RR@dater{\RR@month\space \number\the\year}%
 \RR@dater%
 \@warning{No \string\RRdater \space seen:
         \RR@dater\space will be used.}}
\newcommand\RRversion[1]{\gdef\RR@version{#1}\global\RR@versiontrue}
\newcommand\RR@version{Initial version}%
\newif\ifRR@version\RR@versionfalse
\newcommand\RRauthor[1]{\gdef\RR@author{#1}\gdef\@authorhead{#1}}
\newcommand\RR@author{??\gdef\RR@author{??}%
\@latex@error{No author given,^^J
   use \string\RRauthor\string{Prenom1 Nom1 \string\and\space  Prenom2
    Nom2 \string\and \space...\string}}\@eha}
\newcommand\RRtitle[1]{\gdef\RR@title{#1}}
\newcommand\RR@title{}
\def\set@titlehead{%
  {\if@dc@french\global\RR@frenchtrue
   \else
     \def\tempa{french}\def\tempb{frenchb}%
     \ifx\bbl@main@language\tempa\global\RR@frenchtrue\fi
     \ifx\bbl@main@language\tempb\global\RR@frenchtrue\fi
     \@ifundefined{ifFrench}{}{\global\RR@frenchtrue}%
   \fi
   \def\tempa{}%
   \ifx\@titlehead\tempa \gdef\@titlehead{\RR@title}\fi}}
\AtBeginDocument{\set@titlehead}
\newcommand\RRnote[1]{\begingroup
  \let\protect\@unexpandable@protect
  \protected@xdef\RR@note{\RR@note \protect\footnotetext[0]{#1\par}}%
  \endgroup}
\newcommand\RR@note{}
\def\RRobsolete#1{%
\@latex@error{Obsolete command `\@backslashchar#1' ignored}\@eha}

%% set projets variables to empty values
\newcommand\RR@prjtype{Project-Team}
\newcommand\RR@fprjtype{\'Equipe-Projet}
\newcommand\RRprojet[1]{\gdef\RR@projet{#1}}
\newcommand\RRprojets[1]{\gdef\RR@fprjtype{\'Equipes-Projets}
  \gdef\RR@prjtype{Project-Teams}\gdef\RR@projet{#1}}
\newcommand\RRprojecttype[1]{\gdef\RR@prjtype{#1}}
\newcommand\RRfrprojecttype[1]{\gdef\RR@fprjtype{#1}}
\newcommand\RRprojectinfo[1]{\gdef\RR@prjtype{#1}}
\let\RRequipe\RRprojet
\let\RRequipes\RRprojets
\newcommand\RR@projet{??\latex@error{Team missing, use
 \string\RRprojet}\@eha}
\RRprojecttype{}
\RRfrprojecttype{}
\RRprojet{}
\RRprojets{}

 
% define number of last page
\newcommand\RRnbpage[1]{\gdef\RR@nbpage{#1}}
\newcommand\RR@nbpage{\@ifundefined{r@RRlastpageofreport}{??}
  {\pageref{RRlastpageofreport}}}

% provide a way to insert an abstract
% default value is no abstract
\newcommand\RRabstract[1]{%
    \long\def\RR@abstract{\noindent{\bf Abstract: } #1\par}}
\RRabstract{No abstract}

% provide a way to define keywords
% default value is "No keywords"
\newcommand\RRkeyword[1]{%
   \def\RR@keyword{\noindent{\bf Keywords: } #1\par}}
\RRkeyword{No keywords}
\let\abstract=\RRabstract
\let\keyword=\RRkeyword
\let\RR@rc@name\relax \let\RR@rc\empty

% define lab address
\newcommand\RCLimos{\gdef\RR@rc@name{limos}
  \def\RR@rc{LIMOS - UMR CNRS 6158}
  \def\RR@adr{Campus des C\'ezeaux\\
	      B\^atiment ISIMA\\
	      BP 10125\\
	      63173 Aubi\`ere Cedex}}
\let\URLimos\RCLimos\RCLimos
% and allow users to redefine it
\newcommand\RRrcname[1]{\gdef\RR@rc@name{#1}}
\newcommand\RRrc[1]{\gdef\RR@rc{#1}}
\newcommand\RRadr[1]{\gdef\RR@adr{#1}}


% define layout of the second page
\newcommand\rr@frame{%
 \RR@atxy{0mm}{10mm}{\includegraphics{pagei}}
 \RR@atxy{48mm}{28mm}{\includegraphics[keepaspectratio]{\RR@logo}}
 \RR@atxy{40mm}{256mm}{\hbox{\cr@font\color{blue}RESEARCH CENTRE}}
 \RR@atxy{40mm}{259mm}{\hbox{\cr@font\color{blue}\RR@rc}}
 \RR@atxy{40mm}{263mm}{\vbox{\hsize=18cm{\noindent\issn@font\RR@adr}}}}
 
% define layout of the last page
% also a nice way to insert a label in the last page, so that
% the total number of pages can be displayed
% you're as cunning as a fox buddy!
\newcommand\lastRRpage{
  \clearpage\thispagestyle{empty}
  \csname phantomsection\endcsname
  \label{RRlastpageofreport}
  \addtocounter{page}{-1}
  \null\vfill\rr@frame
  \RR@atxy{98mm}{255mm}{\hbox{\vbox{\parindent=0pt \issn@font
     \hsize=48mm \raggedright \hyphenpenalty 10000
      \RR@footerLastPage\\[3mm]
      }}}
  \clearpage}
\AtEndDocument{\lastRRpage}

% define ISSN that will be inserted at the bottom right of the first page
\newcommand\RR@issn{%
 \setbox0\hbox{\rotatebox{90}{\issn@font\color{white}
%    ISSN XXX-XXX-XXX
 %   \qquad ISRN LIMOS/\RR@cond{RR}{RT}-{}-\RR@No-{}-FR+ENG
 }}
    \dimen0=272mm \advance\dimen0 by -\ht0
 \RR@atxy{190mm}{\dimen0}{\box0}}
 

\def\@nothanks{\@ifnextchar[{\@xnothanks}{\@gobble}}
\def\@xnothanks[#1]#2{\relax}
\def\@xthanks[#1]#2{\orig@thanks{#2}
  \expandafter\edef\csname @footnote@#1\endcsname{\the\c@footnote}}
\def\thanksref#1{\footnotemark[\csname @footnote@#1\endcsname]}


\newcommand\@out@CR{%
  \dimen0=25cm
  \advance\dimen0 -\ht0
  \dimen1=1in
  \advance\dimen1\topmargin
  \advance\dimen1\headheight
  \advance\dimen1\headsep
  \advance\dimen1\textheight
  \advance\dimen1\footskip
  \ifdim \dimen1>\dimen0
     \advance\dimen1 -\dimen0 \enlargethispage{-\dimen1}\fi}
\newif\ifRR@RT
\newcommand\makeRR{\RR@RTtrue{\@makeRRorRT}}
\newcommand\makeRT{\RR@RTfalse{\@makeRRorRT}}
\newcommand\rr@dash{ --- }
\newcommand\RR@cond[2]{\ifRR@RT#1\else#2\fi}
\def\RR@start{
   \global\let\makeRR\relax\global\let\makeRT\relax
   \let\orig@thanks\thanks
   \def\thanks{\@ifnextchar[ {\@xthanks}{\orig@thanks}}% ]
   \@ifundefined{english}{\def\english{}}{}
   \@ifundefined{french}{\def\french{}}{}
   \ifx\RR@rc@name\relax \@latex@error{Missing research group/affiliation}
      \@eha {\gdef\RR@rc@name{bordeaux}}%
   \fi
   \gdef\and{\unskip, }
   \@restonecolfalse
   \if@twocolumn\@restonecoltrue\onecolumn\fi}
\def\RR@fplow{%
  \RR@atxy{40mm}{240mm}{\hbox{\vbox{\parindent=0pt%
     \hsize=48mm \raggedright \hyphenpenalty 10000
     \color{blue}%
{ \theme@font \textit{From:}\\[3mm]
 \rrno@font \RR@source}
      \theme@font\\[2mm]
      \RR@date\\[3mm] \RR@prjtype~\RR@projet}}}}
\def\RR@fpmiddle{%
 \RR@atxy{38mm}{113mm}{\hbox{\vbox to 10cm{\hsize=14cm
   \begin{raggedright}
     \def\footnote##1{\relax}%
     \let\thanks\@nothanks
     \def\footnotemark{%
         \@ifnextchar[\my@xfootnotemark\relax} %]
     \def\my@xfootnotemark[##1]{\relax}%
     \color{white}
     {\title@font  \baselineskip43pt
       {\RR@title}
       \\[1cm]}
     \baselineskip16pt
     {\author@font\RR@author}%
     \vfill
   \end{raggedright}}}}}
\def\RR@sp{{%
\def\thefootnote{\fnsymbol{footnote}}
\setcounter{footnote}{0}
\def\@makefnmark{\hbox{\@textsuperscript{\@thefnmark}}}
\long\def\@makefntext##1{\parindent 1em\noindent
         \hb@xt@1.8em{%
             \hss\@textsuperscript{\normalfont\@thefnmark}} ##1}%
\let\footnoterule\relax
\null\@out@CR  \vskip 3cm \rr@frame
\begin{center}
\dimen0=\@themargin\advance \dimen0 by -26mm
\advance \rightskip by \dimen0
\advance \leftskip by -\dimen0\hsize 115mm
   {\Large\bf \RR@title \par}
   \vskip 2em
   {\large \lineskip .75em \RR@author \par}
   \vskip 1em
   \normalsize
   \ifRR@french \RR@fprjtype\else\RR@prjtype\fi
    ~\RR@projet \par
   \vskip 1em
   \ifRR@french
     Rapport \RR@cond{de recherche}{technique}
   \else
     Originally published in: \RR@source    
   \fi
   %\space n\textdegree{} \RR@No  \rr@dash
   \ifRR@version
     \ifRR@french
        version initiale \RR@date\rr@dash version r\'evis\'ee \RR@dater
     \else
        initial version \RR@date\rr@dash reviewed version \RR@dater
     \fi
   \else
     \rr@dash \RR@date
   \fi
   \rr@dash pp \RR@originalpages\\
   \RR@additionalinformation\\
   \RR@copyright
\end{center}
\RR@note
\@thanks
 \vfil
\dimen0=\@themargin
\advance \dimen0 by -11mm
\noindent\kern-\dimen0\parbox{150mm}{%
      \RR@abstract\par\vskip2mm \RR@keyword}}}
\newcommand\@makeRRorRT{%
  \RR@start\topmargin=18pt
  \thispagestyle{empty}\pagestyle{empty}
  \ifRR@firstpage 
     \RR@atxy{0cm}{10mm}{\includegraphics{rrpage1.eps}}
     \RR@atxy{38mm}{35mm}{\includegraphics[width=50mm]{\RR@logo}}
     \RR@issn   \RR@fplow \RR@fpmiddle
     \null\vfill  \c@page\z@ \newpage
     \null\vfill  \c@page\z@ \newpage
  \fi   
  %\RR@sp \vfil  \newpage
  \RR@sp \vfil 
   {\ifRR@french \english\fi
     {\Large\bf  \begin{center}
       \RR@title
        \end{center}}
    % \pagebreak[0]
    % \ifRR@french \RR@abstract\par\vskip2mm \RR@keyword \french\else
     %   \french
%\RR@resume \par\vskip2mm \RR@motcle\fi
 }
   \vfil \null \newpage
   \if@restonecol\twocolumn\fi
  \setcounter{footnote}{0}
  \global\def\thanks##1{\relax}}
\newcommand\@inibe{%
      \let\\\space
      \let\thanks\@nothanks%
      \def\footnotemark[##1]{\relax}}
\newcommand\ps@pi{\let\@mkboth\@gobbletwo%
  \def\@oddhead{\vbox{\hbox to \textwidth{%
    \normalsize\normalfont{\itshape \@inibe\@titlehead}\hfil\thepage}%
    \hbox{\rule[-1ex]{\textwidth}{.03cm}}}}
  %\def\@oddfoot{{\normalfont\footnotesize \RR@cond{RR}{RT}%
   % \space n\textdegree{} \RR@No{}}\hfill}
  \def\@evenhead{\vbox{\hbox to \textwidth{%
    \normalsize\normalfont\thepage\hfil{\itshape \@inibe\@authorhead}}
    \hbox{\rule[-1ex]{\textwidth}{.03cm}}}}%
  \def\@evenfoot{\hfill{\footnotesize\normalfont }}}
\let\ps@plain\ps@pi
\headheight1cm
\headsep1cm
\pagestyle{pi}
\@ifundefined{chapter}{\relax}
   {\def\chapter{\cleardoublepage \thispagestyle{pi}
   \global\@topnum\z@ \@afterindentfalse \secdef\@chapter\@schapter}}
%%\textwidth14cm
%%\textheight18cm
%%\evensidemargin0.96cm
%%\oddsidemargin0.96cm
%%\footskip2cm

\endinput
%%
%% End of file `fRRee.sty'.
